(()=>{"use strict";function t(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function e(n){const l=t(0,99);return null===n.objList[l].attacked?l:e(n)}const n=t=>({sendAttack:n=>{if(n)t.receiveAttack(n);else{const n=e(t);t.receiveAttack(n)}},activePlayer:!1});function l(t,e){for(let n=0;n<t.length;n+=1)if(t[n][0]===e[0]&&t[n][1]===e[1])return n}const i=()=>{const e=(()=>{const t=[];for(let e=0;e<10;e+=1)for(let n=0;n<10;n+=1)t.push([e,n]);return t})(),n=(t=>{const e=[];for(let n=0;n<t.length;n+=1)e[n]={ship:null,attacked:null};return e})(e),i=(t,i,c)=>{let s=!0;const o=[t[0],t[1]],a=l(e,o);function r(t){void 0!==n[t-1]&&null!==n[t-1].ship&&(s=!1)}function d(t){void 0!==n[t+1]&&null!==n[t+1].ship&&(s=!1)}function u(t){void 0!==n[t-10]&&null!==n[t-10].ship&&(s=!1)}function h(t){void 0!==n[t+10]&&null!==n[t+10].ship&&(s=!1)}if(null!=n[a].ship&&(s=!1),r(a),d(a),u(a),h(a),"x"===c)for(let t=1;t<i;t+=1)null!=n[a+t].ship&&(s=!1),d(a+t),u(a+t),h(a+t);else{let t=10;for(let e=1;e<i;e+=1)null!=n[a-t].ship&&(s=!1),r(a-t),d(a-t),u(a-t),t+=10}return s},c=(t,i,c)=>{const s=(t=>{const e=t;let n=0;return{shipLength:e,hitNum:n,hit:()=>{n+=1},getHitNum:()=>n,isSunk:()=>n>=e}})(i),o=[t[0],t[1]],a=l(e,o);if(n[a].ship=s,"x"===c)for(let t=1;t<i;t+=1)n[a+t].ship=s;else{let t=10;for(let e=1;e<i;e+=1)n[a-t].ship=s,t+=10}};return{board:e,objList:n,placeShip:c,placeRandomShips:()=>{function e(n){const l=0===t(0,1)?"x":"y",s=function(e,n){let l,i;return"x"===e?(l=t(0,9),i=t(0,9-(n-1))):(l=t(n-1+0,9),i=t(0,9)),[l,i]}(l,n);!0===i(s,n,l)?c(s,n,l):e(n)}e(5),e(4),e(3),e(3),e(2)},hasShip:t=>{const i=[t[0],t[1]],c=l(e,i);return null!=n[c].ship},receiveAttack:t=>{null!=n[t].ship?(n[t].ship.hit(),n[t].attacked=!0):n[t].attacked=!0},allShipsSunk:()=>{let t=!0;for(let e=0;e<n.length;e+=1)n[e].ship&&!0!==n[e].ship.isSunk()&&(t=!1);return t}}},c=(t,e,n)=>{const l=n.objList;return{displayGrid:()=>{for(let n=0;n<100;n+=1){const i=document.createElement("div");i.classList.add("square"),!0===e.activePlayer?null!=l[n].ship&&null===l[n].attacked?i.classList.add("ship"):null!=l[n].ship&&!0===l[n].attacked?i.classList.add("hit-ship"):null===l[n].ship&&!0===l[n].attacked&&i.classList.add("hit-miss"):(i.classList.add("active"),null!=l[n].ship&&!0===l[n].attacked?i.classList.add("hit-ship"):null===l[n].ship&&!0===l[n].attacked&&i.classList.add("hit-miss")),t.appendChild(i)}},removeGrid:()=>{for(;t.firstChild;)t.removeChild(t.firstChild)}}},s=document.querySelector("#start"),o=document.querySelector(".p1-container"),a=document.querySelector(".p2-container"),r=document.querySelector(".grid-header1"),d=document.querySelector(".grid-header2");s.addEventListener("click",(()=>{const t=document.querySelector(".header");t.removeChild(s);const e=document.createElement("h3");e.textContent="YOUR BOARD",r.appendChild(e);const l=document.createElement("h3");l.textContent="ENEMY BOARD",d.appendChild(l);const u=document.createElement("p");u.classList.add("instructions"),u.textContent="Click a square on the enemy's board to launch an attack!",t.appendChild(u),(()=>{const t=i();t.placeRandomShips();const e=i();e.placeRandomShips();const l=n(e),s=n(t),r=c(o,l,t),d=c(a,s,e);l.activePlayer=!0,r.displayGrid(),d.displayGrid(),((t,e,n,l,i,c)=>{const s=()=>{t.removeGrid(),e.removeGrid(),t.displayGrid(),e.displayGrid()};function o(){return!0===n.allShipsSunk()||!0===l.allShipsSunk()}const a=()=>{document.getElementById("myModal").style.display="block";const t=document.querySelector(".modal-content"),e=document.createElement("p");t.appendChild(e),!0===n.allShipsSunk()?e.textContent="You lost! Better luck next time.":e.textContent="You won! Play again?";const l=document.createElement("button");t.appendChild(l),l.textContent="NEW GAME",l.addEventListener("click",(()=>{location.reload()}))},r=()=>{const t=document.querySelectorAll(".active");for(let e=0;e<t.length;e+=1)t[e].addEventListener("click",(()=>null!==l.objList[e].attacked?r():(l.receiveAttack(e),s(),!0!==o()?d():void a())))},d=()=>{c.sendAttack(),s(),!0===o()?a():r()};return{humanPlay:r,computerPlay:d}})(r,d,t,e,0,s).humanPlay()})()}))})();